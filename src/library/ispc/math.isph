#ifndef PR_ISPC_MATH
#define PR_ISPC_MATH

#ifndef ISPC
#error This file is for the ISPC compiler only!
#endif

inline void sample_cos_hemi(float u1, float u2,
	float& pdf, float& dx, float& dy, float& dz)
{
	const float cosPhi = sqrt(u1);
	const float sinPhi = sqrt(1 - u1); // Faster?
	const float theta  = 2 * PI * u2;

	const float thSin = sin(theta);
	const float thCos = cos(theta);

	dx = sinPhi * thCos;
	dy = sinPhi * thSin;
	dz = cosPhi;

	pdf = cosPhi / PI;
}

#endif//PR_ISPC_MATH